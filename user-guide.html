
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>User Guide &#8212; google-auth 1.30.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="google" href="reference/modules.html" />
    <link rel="prev" title="google-auth" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">¶</a></h1>
<section id="credentials-and-account-types">
<h2>Credentials and account types<a class="headerlink" href="#credentials-and-account-types" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="reference/google.auth.credentials.html#google.auth.credentials.Credentials" title="google.auth.credentials.Credentials"><code class="xref py py-class docutils literal notranslate"><span class="pre">Credentials</span></code></a> are the means of identifying an application or
user to a service or API. Credentials can be obtained with three different types
of accounts: <em>service accounts</em>, <em>user accounts</em> and <em>external accounts</em>.</p>
<p>Credentials from service accounts identify a particular application. These types
of credentials are used in server-to-server use cases, such as accessing a
database. This library primarily focuses on service account credentials.</p>
<p>Credentials from user accounts are obtained by asking the user to authorize
access to their data. These types of credentials are used in cases where your
application needs access to a user’s data in another service, such as accessing
a user’s documents in Google Drive. This library provides no support for
obtaining user credentials, but does provide limited support for using user
credentials.</p>
<p>Credentials from external accounts (workload identity federation) are used to
identify a particular application from an on-prem or non-Google Cloud platform
including Amazon Web Services (AWS), Microsoft Azure or any identity provider
that supports OpenID Connect (OIDC).</p>
</section>
<section id="obtaining-credentials">
<h2>Obtaining credentials<a class="headerlink" href="#obtaining-credentials" title="Permalink to this headline">¶</a></h2>
<section id="application-default-credentials">
<span id="application-default"></span><h3>Application default credentials<a class="headerlink" href="#application-default-credentials" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://developers.google.com/identity/protocols/application-default-credentials">Google Application Default Credentials</a> abstracts authentication across the
different Google Cloud Platform hosting environments. When running on any Google
Cloud hosting environment or when running locally with the <a class="reference external" href="https://cloud.google.com/sdk">Google Cloud SDK</a>
installed, <a class="reference internal" href="reference/google.auth.html#google.auth.default" title="google.auth.default"><code class="xref py py-func docutils literal notranslate"><span class="pre">default()</span></code></a> can automatically determine the credentials from the
environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">google.auth</span>

<span class="n">credentials</span><span class="p">,</span> <span class="n">project</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">default</span><span class="p">()</span>
</pre></div>
</div>
<p>If your application requires specific scopes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">credentials</span><span class="p">,</span> <span class="n">project</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">default</span><span class="p">(</span>
    <span class="n">scopes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/cloud-platform&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Application Default Credentials also support workload identity federation to
access Google Cloud resources from non-Google Cloud platforms including Amazon
Web Services (AWS), Microsoft Azure or any identity provider that supports
OpenID Connect (OIDC). Workload identity federation is recommended for
non-Google Cloud environments as it avoids the need to download, manage and
store service account private keys locally.</p>
</section>
<section id="service-account-private-key-files">
<h3>Service account private key files<a class="headerlink" href="#service-account-private-key-files" title="Permalink to this headline">¶</a></h3>
<p>A service account private key file can be used to obtain credentials for a
service account. You can create a private key using the <a class="reference external" href="https://console.cloud.google.com/apis/credentials">Credentials page of the
Google Cloud Console</a>. Once you have a private key you can either obtain
credentials one of three ways:</p>
<ol class="arabic">
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">GOOGLE_APPLICATION_CREDENTIALS</span></code> environment variable to the full
path to your service account private key file</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span>/path/to/key.json
</pre></div>
</div>
<p>Then, use <a class="reference internal" href="#application-default"><span class="std std-ref">application default credentials</span></a>.
<a class="reference internal" href="reference/google.auth.html#google.auth.default" title="google.auth.default"><code class="xref py py-func docutils literal notranslate"><span class="pre">default()</span></code></a> checks for the <code class="docutils literal notranslate"><span class="pre">GOOGLE_APPLICATION_CREDENTIALS</span></code>
environment variable before all other checks, so this will always use the
credentials you explicitly specify.</p>
</li>
<li><p>Use <a class="reference internal" href="reference/google.oauth2.service_account.html#google.oauth2.service_account.Credentials.from_service_account_file" title="google.oauth2.service_account.Credentials.from_service_account_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">service_account.Credentials.from_service_account_file</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.oauth2</span> <span class="kn">import</span> <span class="n">service_account</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span>
    <span class="s1">&#39;/path/to/key.json&#39;</span><span class="p">)</span>

<span class="n">scoped_credentials</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">with_scopes</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/cloud-platform&#39;</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Use <a class="reference internal" href="reference/google.oauth2.service_account.html#google.oauth2.service_account.Credentials.from_service_account_info" title="google.oauth2.service_account.Credentials.from_service_account_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">service_account.Credentials.from_service_account_info</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">google.oauth2</span> <span class="kn">import</span> <span class="n">service_account</span>

<span class="n">json_acct_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">function_to_get_json_creds</span><span class="p">())</span>
<span class="n">credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_service_account_info</span><span class="p">(</span>
    <span class="n">json_acct_info</span><span class="p">)</span>

<span class="n">scoped_credentials</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">with_scopes</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/cloud-platform&#39;</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Private keys must be kept secret. If you expose your private key it
is recommended to revoke it immediately from the Google Cloud Console.</p>
</div>
</section>
<section id="compute-engine-container-engine-and-the-app-engine-flexible-environment">
<h3>Compute Engine, Container Engine, and the App Engine flexible environment<a class="headerlink" href="#compute-engine-container-engine-and-the-app-engine-flexible-environment" title="Permalink to this headline">¶</a></h3>
<p>Applications running on <a class="reference external" href="https://cloud.google.com/compute">Compute Engine</a>, <a class="reference external" href="https://cloud.google.com/container-engine">Container Engine</a>, or the <a class="reference external" href="https://cloud.google.com/appengine/docs/flexible/">App
Engine flexible environment</a> can obtain credentials provided by <a class="reference external" href="https://cloud.google.com/compute/docs/access/service-accounts">Compute
Engine service accounts</a>. When running on these platforms you can obtain
credentials for the service account one of two ways:</p>
<ol class="arabic">
<li><p>Use <a class="reference internal" href="#application-default"><span class="std std-ref">application default credentials</span></a>.
<a class="reference internal" href="reference/google.auth.html#google.auth.default" title="google.auth.default"><code class="xref py py-func docutils literal notranslate"><span class="pre">default()</span></code></a> will automatically detect if these credentials are available.</p></li>
<li><p>Use <a class="reference internal" href="reference/google.auth.compute_engine.html#google.auth.compute_engine.Credentials" title="google.auth.compute_engine.Credentials"><code class="xref py py-class docutils literal notranslate"><span class="pre">compute_engine.Credentials</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">compute_engine</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">compute_engine</span><span class="o">.</span><span class="n">Credentials</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="the-app-engine-standard-environment">
<h3>The App Engine standard environment<a class="headerlink" href="#the-app-engine-standard-environment" title="Permalink to this headline">¶</a></h3>
<p>Applications running on the <a class="reference external" href="https://cloud.google.com/appengine/docs/python">App Engine standard environment</a> can obtain
credentials provided by the <a class="reference external" href="https://cloud.google.com/appengine/docs/python/appidentity/">App Engine App Identity API</a>. You can obtain
credentials one of two ways:</p>
<ol class="arabic">
<li><p>Use <a class="reference internal" href="#application-default"><span class="std std-ref">application default credentials</span></a>.
<a class="reference internal" href="reference/google.auth.html#google.auth.default" title="google.auth.default"><code class="xref py py-func docutils literal notranslate"><span class="pre">default()</span></code></a> will automatically detect if these credentials are available.</p></li>
<li><p>Use <a class="reference internal" href="reference/google.auth.app_engine.html#google.auth.app_engine.Credentials" title="google.auth.app_engine.Credentials"><code class="xref py py-class docutils literal notranslate"><span class="pre">app_engine.Credentials</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">app_engine</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">app_engine</span><span class="o">.</span><span class="n">Credentials</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
<p>In order to make authenticated requests in the App Engine environment using the
credentials and transports provided by this library, you need to follow a few
additional steps:</p>
<ol class="arabic">
<li><p>If you are using the <a class="reference internal" href="reference/google.auth.transport.requests.html#module-google.auth.transport.requests" title="google.auth.transport.requests"><code class="xref py py-mod docutils literal notranslate"><span class="pre">google.auth.transport.requests</span></code></a> transport, vendor
in the <a class="reference external" href="https://toolbelt.readthedocs.io/en/latest/">requests-toolbelt</a> library into your app, and enable the App Engine
monkeypatch. Refer <a class="reference external" href="https://cloud.google.com/appengine/docs/standard/python/issue-requests">App Engine documentation</a> for more details on this.</p></li>
<li><p>To make HTTPS calls, enable the <code class="docutils literal notranslate"><span class="pre">ssl</span></code> library for your app by adding the
following configuration to the <code class="docutils literal notranslate"><span class="pre">app.yaml</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">libraries</span><span class="p">:</span>
<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">ssl</span>
  <span class="n">version</span><span class="p">:</span> <span class="n">latest</span>
</pre></div>
</div>
</li>
<li><p>Enable billing for your App Engine project. Then enable socket support for
your app. This can be achieved by setting an environment variable in the
<code class="docutils literal notranslate"><span class="pre">app.yaml</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env_variables</span><span class="p">:</span>
  <span class="n">GAE_USE_SOCKETS_HTTPLIB</span> <span class="p">:</span> <span class="s1">&#39;true&#39;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="user-credentials">
<h3>User credentials<a class="headerlink" href="#user-credentials" title="Permalink to this headline">¶</a></h3>
<p>User credentials are typically obtained via <a class="reference external" href="https://developers.google.com/identity/protocols/OAuth2">OAuth 2.0</a>. This library does not
provide any direct support for <em>obtaining</em> user credentials, however, you can
use user credentials with this library. You can use libraries such as
<a class="reference external" href="https://oauthlib.readthedocs.io/en/latest/">oauthlib</a> to obtain the access token. After you have an access token, you
can create a <a class="reference internal" href="reference/google.oauth2.credentials.html#google.oauth2.credentials.Credentials" title="google.oauth2.credentials.Credentials"><code class="xref py py-class docutils literal notranslate"><span class="pre">google.oauth2.credentials.Credentials</span></code></a> instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">google.oauth2.credentials</span>

<span class="n">credentials</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">oauth2</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">(</span>
    <span class="s1">&#39;access_token&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you obtain a refresh token, you can also specify the refresh token and token
URI to allow the credentials to be automatically refreshed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">credentials</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">oauth2</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">(</span>
    <span class="s1">&#39;access_token&#39;</span><span class="p">,</span>
    <span class="n">refresh_token</span><span class="o">=</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">,</span>
    <span class="n">token_uri</span><span class="o">=</span><span class="s1">&#39;token_uri&#39;</span><span class="p">,</span>
    <span class="n">client_id</span><span class="o">=</span><span class="s1">&#39;client_id&#39;</span><span class="p">,</span>
    <span class="n">client_secret</span><span class="o">=</span><span class="s1">&#39;client_secret&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>There is a separate library, <a class="reference external" href="https://pypi.python.org/pypi/google-auth-oauthlib">google-auth-oauthlib</a>, that has some helpers
for integrating with <a class="reference external" href="https://requests-oauthlib.readthedocs.io/en/latest/">requests-oauthlib</a> to provide support for obtaining
user credentials. You can use
<code class="xref py py-func docutils literal notranslate"><span class="pre">google_auth_oauthlib.helpers.credentials_from_session()</span></code> to obtain
<a class="reference internal" href="reference/google.oauth2.credentials.html#google.oauth2.credentials.Credentials" title="google.oauth2.credentials.Credentials"><code class="xref py py-class docutils literal notranslate"><span class="pre">google.oauth2.credentials.Credentials</span></code></a> from a
<a class="reference external" href="https://requests-oauthlib.readthedocs.io/en/stable/api.html#requests_oauthlib.OAuth2Session" title="(in Requests-OAuthlib v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">requests_oauthlib.OAuth2Session</span></code></a> as above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google_auth_oauthlib.helpers</span> <span class="kn">import</span> <span class="n">credentials_from_session</span>

<span class="n">google_auth_credentials</span> <span class="o">=</span> <span class="n">credentials_from_session</span><span class="p">(</span><span class="n">oauth2session</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also use <code class="xref py py-class docutils literal notranslate"><span class="pre">google_auth_oauthlib.flow.Flow</span></code> to perform the OAuth
2.0 Authorization Grant Flow to obtain credentials using <a class="reference external" href="https://requests-oauthlib.readthedocs.io/en/latest/">requests-oauthlib</a>.</p>
</section>
<section id="external-credentials-workload-identity-federation">
<h3>External credentials (Workload identity federation)<a class="headerlink" href="#external-credentials-workload-identity-federation" title="Permalink to this headline">¶</a></h3>
<p>Using workload identity federation, your application can access Google Cloud
resources from Amazon Web Services (AWS), Microsoft Azure or any identity
provider that supports OpenID Connect (OIDC).</p>
<p>Traditionally, applications running outside Google Cloud have used service
account keys to access Google Cloud resources. Using identity federation,
you can allow your workload to impersonate a service account.
This lets you access Google Cloud resources directly, eliminating the
maintenance and security burden associated with service account keys.</p>
<section id="accessing-resources-from-aws">
<h4>Accessing resources from AWS<a class="headerlink" href="#accessing-resources-from-aws" title="Permalink to this headline">¶</a></h4>
<p>In order to access Google Cloud resources from Amazon Web Services (AWS), the
following requirements are needed:</p>
<ul class="simple">
<li><p>A workload identity pool needs to be created.</p></li>
<li><p>AWS needs to be added as an identity provider in the workload identity pool
(The Google organization policy needs to allow federation from AWS).</p></li>
<li><p>Permission to impersonate a service account needs to be granted to the
external identity.</p></li>
<li><p>A credential configuration file needs to be generated. Unlike service account
credential files, the generated credential configuration file will only
contain non-sensitive metadata to instruct the library on how to retrieve
external subject tokens and exchange them for service account access tokens.</p></li>
</ul>
<p>Follow the detailed instructions on how to
<a class="reference external" href="https://cloud.google.com/iam/docs/access-resources-aws">Configure Workload Identity Federation from AWS</a>.</p>
</section>
<section id="accessing-resources-from-microsoft-azure">
<h4>Accessing resources from Microsoft Azure<a class="headerlink" href="#accessing-resources-from-microsoft-azure" title="Permalink to this headline">¶</a></h4>
<p>In order to access Google Cloud resources from Microsoft Azure, the following
requirements are needed:</p>
<ul class="simple">
<li><p>A workload identity pool needs to be created.</p></li>
<li><p>Azure needs to be added as an identity provider in the workload identity pool
(The Google organization policy needs to allow federation from Azure).</p></li>
<li><p>The Azure tenant needs to be configured for identity federation.</p></li>
<li><p>Permission to impersonate a service account needs to be granted to the
external identity.</p></li>
<li><p>A credential configuration file needs to be generated. Unlike service account
credential files, the generated credential configuration file will only
contain non-sensitive metadata to instruct the library on how to retrieve
external subject tokens and exchange them for service account access tokens.</p></li>
</ul>
<p>Follow the detailed instructions on how to
<a class="reference external" href="https://cloud.google.com/iam/docs/access-resources-azure">Configure Workload Identity Federation from Microsoft Azure</a>.</p>
</section>
<section id="accessing-resources-from-an-oidc-identity-provider">
<h4>Accessing resources from an OIDC identity provider<a class="headerlink" href="#accessing-resources-from-an-oidc-identity-provider" title="Permalink to this headline">¶</a></h4>
<p>In order to access Google Cloud resources from an identity provider that
supports <a class="reference external" href="https://openid.net/connect/">OpenID Connect (OIDC)</a>, the following requirements are needed:</p>
<ul class="simple">
<li><p>A workload identity pool needs to be created.</p></li>
<li><p>An OIDC identity provider needs to be added in the workload identity pool
(The Google organization policy needs to allow federation from the identity
provider).</p></li>
<li><p>Permission to impersonate a service account needs to be granted to the
external identity.</p></li>
<li><p>A credential configuration file needs to be generated. Unlike service account
credential files, the generated credential configuration file will only
contain non-sensitive metadata to instruct the library on how to retrieve
external subject tokens and exchange them for service account access tokens.</p></li>
</ul>
<p>For OIDC providers, the Auth library can retrieve OIDC tokens either from a
local file location (file-sourced credentials) or from a local server
(URL-sourced credentials).</p>
<ul class="simple">
<li><p>For file-sourced credentials, a background process needs to be continuously
refreshing the file location with a new OIDC token prior to expiration.
For tokens with one hour lifetimes, the token needs to be updated in the file
every hour. The token can be stored directly as plain text or in JSON format.</p></li>
<li><p>For URL-sourced credentials, a local server needs to host a GET endpoint to
return the OIDC token. The response can be in plain text or JSON.
Additional required request headers can also be specified.</p></li>
</ul>
<p>Follow the detailed instructions on how to
<a class="reference external" href="https://cloud.google.com/iam/docs/access-resources-oidc">Configure Workload Identity Federation from an OIDC identity provider</a>.</p>
</section>
<section id="using-external-identities">
<h4>Using External Identities<a class="headerlink" href="#using-external-identities" title="Permalink to this headline">¶</a></h4>
<p>External identities (AWS, Azure and OIDC identity providers) can be used with
Application Default Credentials.
In order to use external identities with Application Default Credentials, you
need to generate the JSON credentials configuration file for your external
identity.
Once generated, store the path to this file in the
<code class="docutils literal notranslate"><span class="pre">GOOGLE_APPLICATION_CREDENTIALS</span></code> environment variable.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span>/path/to/config.json
</pre></div>
</div>
<p>The library can now automatically choose the right type of client and initialize
credentials from the context provided in the configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">google.auth</span>

<span class="n">credentials</span><span class="p">,</span> <span class="n">project</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">default</span><span class="p">()</span>
</pre></div>
</div>
<p>When using external identities with Application Default Credentials,
the <code class="docutils literal notranslate"><span class="pre">roles/browser</span></code> role needs to be granted to the service account.
The <code class="docutils literal notranslate"><span class="pre">Cloud</span> <span class="pre">Resource</span> <span class="pre">Manager</span> <span class="pre">API</span></code> should also be enabled on the project.
This is needed since <a class="reference internal" href="reference/google.auth.html#google.auth.default" title="google.auth.default"><code class="xref py py-func docutils literal notranslate"><span class="pre">default()</span></code></a> will try to auto-discover the project ID
from the current environment using the impersonated credential.
Otherwise, the project ID will resolve to <code class="docutils literal notranslate"><span class="pre">None</span></code>. You can override the project
detection by setting the <code class="docutils literal notranslate"><span class="pre">GOOGLE_CLOUD_PROJECT</span></code> environment variable.</p>
<p>You can also explicitly initialize external account clients using the generated
configuration file.</p>
<p>For Azure and OIDC providers, use <a class="reference internal" href="reference/google.auth.identity_pool.html#google.auth.identity_pool.Credentials.from_info" title="google.auth.identity_pool.Credentials.from_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">identity_pool.Credentials.from_info</span></code></a> or
<a class="reference internal" href="reference/google.auth.identity_pool.html#google.auth.identity_pool.Credentials.from_file" title="google.auth.identity_pool.Credentials.from_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">identity_pool.Credentials.from_file</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">identity_pool</span>

<span class="n">json_config_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">function_to_get_json_config</span><span class="p">())</span>
<span class="n">credentials</span> <span class="o">=</span> <span class="n">identity_pool</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_info</span><span class="p">(</span><span class="n">json_config_info</span><span class="p">)</span>
<span class="n">scoped_credentials</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">with_scopes</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/cloud-platform&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>For AWS providers, use <a class="reference internal" href="reference/google.auth.aws.html#google.auth.aws.Credentials.from_info" title="google.auth.aws.Credentials.from_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">aws.Credentials.from_info</span></code></a> or
<a class="reference internal" href="reference/google.auth.aws.html#google.auth.aws.Credentials.from_file" title="google.auth.aws.Credentials.from_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">aws.Credentials.from_file</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">aws</span>

<span class="n">json_config_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">function_to_get_json_config</span><span class="p">())</span>
<span class="n">credentials</span> <span class="o">=</span> <span class="n">aws</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_info</span><span class="p">(</span><span class="n">json_config_info</span><span class="p">)</span>
<span class="n">scoped_credentials</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">with_scopes</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/cloud-platform&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="impersonated-credentials">
<h3>Impersonated credentials<a class="headerlink" href="#impersonated-credentials" title="Permalink to this headline">¶</a></h3>
<p>Impersonated Credentials allows one set of credentials issued to a user or service account
to impersonate another.  The source credentials must be granted
the “Service Account Token Creator” IAM role.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">impersonated_credentials</span>

<span class="n">target_scopes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://www.googleapis.com/auth/devstorage.read_only&#39;</span><span class="p">]</span>
<span class="n">source_credentials</span> <span class="o">=</span> <span class="n">service_account</span><span class="o">.</span><span class="n">Credentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span>
    <span class="s1">&#39;/path/to/svc_account.json&#39;</span><span class="p">,</span>
    <span class="n">scopes</span><span class="o">=</span><span class="n">target_scopes</span><span class="p">)</span>

<span class="n">target_credentials</span> <span class="o">=</span> <span class="n">impersonated_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">(</span>
    <span class="n">source_credentials</span><span class="o">=</span><span class="n">source_credentials</span><span class="p">,</span>
    <span class="n">target_principal</span><span class="o">=</span><span class="s1">&#39;impersonated-account@_project_.iam.gserviceaccount.com&#39;</span><span class="p">,</span>
    <span class="n">target_scopes</span><span class="o">=</span><span class="n">target_scopes</span><span class="p">,</span>
    <span class="n">lifetime</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">target_credentials</span><span class="p">)</span>
<span class="n">buckets</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;your_project&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">buckets</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bucket</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example above <cite>source_credentials</cite> does not have direct access to list buckets
in the target project.  Using <cite>ImpersonatedCredentials</cite> will allow the source_credentials
to assume the identity of a target_principal that does have access.</p>
</section>
<section id="identity-tokens">
<h3>Identity Tokens<a class="headerlink" href="#identity-tokens" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://developers.google.com/identity/protocols/OpenIDConnect">Google OpenID Connect</a> tokens are available through <a class="reference internal" href="reference/google.oauth2.service_account.html#module-google.oauth2.service_account" title="google.oauth2.service_account"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Service</span> <span class="pre">Account</span></code></a>,
<a class="reference internal" href="reference/google.auth.impersonated_credentials.html#module-google.auth.impersonated_credentials" title="google.auth.impersonated_credentials"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Impersonated</span></code></a>,
and <a class="reference internal" href="reference/google.auth.compute_engine.html#module-google.auth.compute_engine" title="google.auth.compute_engine"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">Engine</span></code></a>.  These tokens can be used to
authenticate against <a class="reference external" href="https://cloud.google.com/functions/">Cloud Functions</a>, <a class="reference external" href="https://cloud.google.com/run/">Cloud Run</a>, a user service behind
<a class="reference external" href="https://cloud.google.com/iap/">Identity Aware Proxy</a> or any other service capable of verifying a <a class="reference external" href="https://developers.google.com/identity/protocols/OpenIDConnect#validatinganidtoken">Google ID Token</a>.</p>
<p>ServiceAccount</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.oauth2</span> <span class="kn">import</span> <span class="n">service_account</span>

<span class="n">target_audience</span> <span class="o">=</span> <span class="s1">&#39;https://example.com&#39;</span>

<span class="n">creds</span> <span class="o">=</span> <span class="n">service_account</span><span class="o">.</span><span class="n">IDTokenCredentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span>
        <span class="s1">&#39;/path/to/svc.json&#39;</span><span class="p">,</span>
        <span class="n">target_audience</span><span class="o">=</span><span class="n">target_audience</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">compute_engine</span>
<span class="kn">import</span> <span class="nn">google.auth.transport.requests</span>

<span class="n">target_audience</span> <span class="o">=</span> <span class="s1">&#39;https://example.com&#39;</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
<span class="n">creds</span> <span class="o">=</span> <span class="n">compute_engine</span><span class="o">.</span><span class="n">IDTokenCredentials</span><span class="p">(</span><span class="n">request</span><span class="p">,</span>
                        <span class="n">target_audience</span><span class="o">=</span><span class="n">target_audience</span><span class="p">)</span>
</pre></div>
</div>
<p>Impersonated</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">impersonated_credentials</span>

<span class="c1"># get target_credentials from a source_credential</span>

<span class="n">target_audience</span> <span class="o">=</span> <span class="s1">&#39;https://example.com&#39;</span>

<span class="n">creds</span> <span class="o">=</span> <span class="n">impersonated_credentials</span><span class="o">.</span><span class="n">IDTokenCredentials</span><span class="p">(</span>
                                  <span class="n">target_credentials</span><span class="p">,</span>
                                  <span class="n">target_audience</span><span class="o">=</span><span class="n">target_audience</span><span class="p">)</span>
</pre></div>
</div>
<p>If your application runs on <a class="reference external" href="https://cloud.google.com/appengine/">App Engine</a>, <a class="reference external" href="https://cloud.google.com/run/">Cloud Run</a>, <a class="reference external" href="https://cloud.google.com/compute">Compute Engine</a>, or
has application default credentials set via <cite>GOOGLE_APPLICATION_CREDENTIALS</cite>
environment variable, you can also use <cite>google.oauth2.id_token.fetch_id_token</cite>
to obtain an ID token from your current running environment. The following is an
example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">google.oauth2.id_token</span>
<span class="kn">import</span> <span class="nn">google.auth.transport.requests</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
<span class="n">target_audience</span> <span class="o">=</span> <span class="s2">&quot;https://pubsub.googleapis.com&quot;</span>

<span class="n">id_token</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">oauth2</span><span class="o">.</span><span class="n">id_token</span><span class="o">.</span><span class="n">fetch_id_token</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">target_audience</span><span class="p">)</span>
</pre></div>
</div>
<p>IDToken verification can be done for various type of IDTokens using the
<a class="reference internal" href="reference/google.oauth2.id_token.html#module-google.oauth2.id_token" title="google.oauth2.id_token"><code class="xref py py-class docutils literal notranslate"><span class="pre">google.oauth2.id_token</span></code></a> module. It supports ID token signed with RS256
and ES256 algorithms. However, ES256 algorithm won’t be available unless
<cite>cryptography</cite> dependency of version at least 1.4.0 is installed. You can check
the dependency with <cite>pip freeze</cite> or try <cite>from google.auth.crypt import es256</cite>.
The following is an example of verifying ID tokens:</p>
<blockquote>
<div><p>from google.auth2 import id_token</p>
<p>request = google.auth.transport.requests.Request()</p>
<dl class="simple">
<dt>try:</dt><dd><p>decoded_token = id_token.verify_token(token_to_verify,request)</p>
</dd>
<dt>except ValueError:</dt><dd><p># Verification failed.</p>
</dd>
</dl>
</div></blockquote>
<p>A sample end-to-end flow using an ID Token against a Cloud Run endpoint maybe</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.oauth2</span> <span class="kn">import</span> <span class="n">id_token</span>
<span class="kn">from</span> <span class="nn">google.oauth2</span> <span class="kn">import</span> <span class="n">service_account</span>
<span class="kn">import</span> <span class="nn">google.auth</span>
<span class="kn">import</span> <span class="nn">google.auth.transport.requests</span>
<span class="kn">from</span> <span class="nn">google.auth.transport.requests</span> <span class="kn">import</span> <span class="n">AuthorizedSession</span>

<span class="n">target_audience</span> <span class="o">=</span> <span class="s1">&#39;https://your-cloud-run-app.a.run.app&#39;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://your-cloud-run-app.a.run.app&#39;</span>

<span class="n">creds</span> <span class="o">=</span> <span class="n">service_account</span><span class="o">.</span><span class="n">IDTokenCredentials</span><span class="o">.</span><span class="n">from_service_account_file</span><span class="p">(</span>
        <span class="s1">&#39;/path/to/svc.json&#39;</span><span class="p">,</span> <span class="n">target_audience</span><span class="o">=</span><span class="n">target_audience</span><span class="p">)</span>

<span class="n">authed_session</span> <span class="o">=</span> <span class="n">AuthorizedSession</span><span class="p">(</span><span class="n">creds</span><span class="p">)</span>

<span class="c1"># make authenticated request and print the response, status_code</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">authed_session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="c1"># to verify an ID Token</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">creds</span><span class="o">.</span><span class="n">token</span>
<span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">id_token</span><span class="o">.</span><span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="making-authenticated-requests">
<h2>Making authenticated requests<a class="headerlink" href="#making-authenticated-requests" title="Permalink to this headline">¶</a></h2>
<p>Once you have credentials you can attach them to a <em>transport</em>. You can then
use this transport to make authenticated requests to APIs. google-auth supports
several different transports. Typically, it’s up to your application or an
opinionated client library to decide which transport to use.</p>
<section id="requests">
<h3>Requests<a class="headerlink" href="#requests" title="Permalink to this headline">¶</a></h3>
<p>The recommended HTTP transport is <a class="reference internal" href="reference/google.auth.transport.requests.html#module-google.auth.transport.requests" title="google.auth.transport.requests"><code class="xref py py-mod docutils literal notranslate"><span class="pre">google.auth.transport.requests</span></code></a> which
uses the <a class="reference external" href="http://docs.python-requests.org/en/master/">Requests</a> library. To make authenticated requests using Requests
you use a custom <a class="reference external" href="http://docs.python-requests.org/en/master/user/advanced/#session-objects">Session</a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.auth.transport.requests</span> <span class="kn">import</span> <span class="n">AuthorizedSession</span>

<span class="n">authed_session</span> <span class="o">=</span> <span class="n">AuthorizedSession</span><span class="p">(</span><span class="n">credentials</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">authed_session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s1">&#39;https://www.googleapis.com/storage/v1/b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="urllib3">
<h3>urllib3<a class="headerlink" href="#urllib3" title="Permalink to this headline">¶</a></h3>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib3</span></code> is the underlying HTTP library used by Requests and can also be
used with google-auth. urllib3’s interface isn’t as high-level as Requests but
it can be useful in situations where you need more control over how HTTP
requests are made. To make authenticated requests using urllib3 create an
instance of <a class="reference internal" href="reference/google.auth.transport.urllib3.html#google.auth.transport.urllib3.AuthorizedHttp" title="google.auth.transport.urllib3.AuthorizedHttp"><code class="xref py py-class docutils literal notranslate"><span class="pre">google.auth.transport.urllib3.AuthorizedHttp</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.auth.transport.urllib3</span> <span class="kn">import</span> <span class="n">AuthorizedHttp</span>

<span class="n">authed_http</span> <span class="o">=</span> <span class="n">AuthorizedHttp</span><span class="p">(</span><span class="n">credentials</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">authed_http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
    <span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.googleapis.com/storage/v1/b&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also construct your own <a class="reference external" href="https://urllib3.readthedocs.io/en/stable/reference/urllib3.poolmanager.html#urllib3.PoolManager" title="(in urllib3 v1.26.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">urllib3.PoolManager</span></code></a> instance and pass
it to <a class="reference internal" href="reference/google.auth.transport.urllib3.html#google.auth.transport.urllib3.AuthorizedHttp" title="google.auth.transport.urllib3.AuthorizedHttp"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuthorizedHttp</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib3</span>

<span class="n">http</span> <span class="o">=</span> <span class="n">urllib3</span><span class="o">.</span><span class="n">PoolManager</span><span class="p">()</span>
<span class="n">authed_http</span> <span class="o">=</span> <span class="n">AuthorizedHttp</span><span class="p">(</span><span class="n">credentials</span><span class="p">,</span> <span class="n">http</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="grpc">
<h3>gRPC<a class="headerlink" href="#grpc" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://www.grpc.io/">gRPC</a> is an RPC framework that uses <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/overview">Protocol Buffers</a> over <a class="reference external" href="http://www.grpc.io/docs/guides/wire.html">HTTP 2.0</a>.
google-auth can provide <a class="reference external" href="http://www.grpc.io/docs/guides/auth.html">Call Credentials</a> for gRPC. The easiest way to do
this is to use google-auth to create the gRPC channel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">google.auth.transport.grpc</span>
<span class="kn">import</span> <span class="nn">google.auth.transport.requests</span>

<span class="n">http_request</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>

<span class="n">channel</span> <span class="o">=</span> <span class="n">google</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">grpc</span><span class="o">.</span><span class="n">secure_authorized_channel</span><span class="p">(</span>
    <span class="n">credentials</span><span class="p">,</span> <span class="n">http_request</span><span class="p">,</span> <span class="s1">&#39;pubsub.googleapis.com:443&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even though gRPC is its own transport, you still need to use one of
the other HTTP transports with gRPC. The reason is that most credential
types need to make HTTP requests in order to refresh their access token.
The sample above uses the Requests transport, but any HTTP transport can
be used. Additionally, if you know that your credentials do not need to
make HTTP requests in order to refresh (as is the case with
<a class="reference internal" href="reference/google.auth.jwt.html#google.auth.jwt.Credentials" title="google.auth.jwt.Credentials"><code class="xref py py-class docutils literal notranslate"><span class="pre">jwt.Credentials</span></code></a>) then you can specify <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div>
<p>Alternatively, you can create the channel yourself and use
<a class="reference internal" href="reference/google.auth.transport.grpc.html#google.auth.transport.grpc.AuthMetadataPlugin" title="google.auth.transport.grpc.AuthMetadataPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">google.auth.transport.grpc.AuthMetadataPlugin</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">grpc</span>

<span class="n">metadata_plugin</span> <span class="o">=</span> <span class="n">AuthMetadataPlugin</span><span class="p">(</span><span class="n">credentials</span><span class="p">,</span> <span class="n">http_request</span><span class="p">)</span>

<span class="c1"># Create a set of grpc.CallCredentials using the metadata plugin.</span>
<span class="n">google_auth_credentials</span> <span class="o">=</span> <span class="n">grpc</span><span class="o">.</span><span class="n">metadata_call_credentials</span><span class="p">(</span>
    <span class="n">metadata_plugin</span><span class="p">)</span>

<span class="c1"># Create SSL channel credentials.</span>
<span class="n">ssl_credentials</span> <span class="o">=</span> <span class="n">grpc</span><span class="o">.</span><span class="n">ssl_channel_credentials</span><span class="p">()</span>

<span class="c1"># Combine the ssl credentials and the authorization credentials.</span>
<span class="n">composite_credentials</span> <span class="o">=</span> <span class="n">grpc</span><span class="o">.</span><span class="n">composite_channel_credentials</span><span class="p">(</span>
    <span class="n">ssl_credentials</span><span class="p">,</span> <span class="n">google_auth_credentials</span><span class="p">)</span>

<span class="n">channel</span> <span class="o">=</span> <span class="n">grpc</span><span class="o">.</span><span class="n">secure_channel</span><span class="p">(</span>
    <span class="s1">&#39;pubsub.googleapis.com:443&#39;</span><span class="p">,</span> <span class="n">composite_credentials</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use this channel to make a gRPC stub that makes authenticated requests
to a gRPC service:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.pubsub.v1</span> <span class="kn">import</span> <span class="n">pubsub_pb2</span>

<span class="n">pubsub</span> <span class="o">=</span> <span class="n">pubsub_pb2</span><span class="o">.</span><span class="n">PublisherStub</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">pubsub</span><span class="o">.</span><span class="n">ListTopics</span><span class="p">(</span>
    <span class="n">pubsub_pb2</span><span class="o">.</span><span class="n">ListTopicsRequest</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;your-project&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">google-auth</a></h1>



<p class="blurb">Google Auth Library for Python</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=GoogleCloudPlatform&repo=google-auth-library-python&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/GoogleCloudPlatform/google-auth-library-python">
    <img
        alt="https://secure.travis-ci.org/GoogleCloudPlatform/google-auth-library-python.svg?branch=master"
        src="https://secure.travis-ci.org/GoogleCloudPlatform/google-auth-library-python.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#credentials-and-account-types">Credentials and account types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#obtaining-credentials">Obtaining credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="#making-authenticated-requests">Making authenticated requests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference/modules.html">Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">google-auth</a></li>
      <li>Next: <a href="reference/modules.html" title="next chapter">google</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Google, Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/user-guide.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/GoogleCloudPlatform/google-auth-library-python" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>